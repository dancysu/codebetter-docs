# æ›´æ–°æ•°æ®

å°ç¨‹åºä¸­ä¿®æ”¹æ•°æ®å¹¶ä¸èƒ½ç›´æŽ¥è¿›è¡Œèµ‹å€¼,è€Œæ˜¯è¦é€šè¿‡è°ƒç”¨ `this.setData` æ–¹æ³•æ‰èƒ½å®žçŽ°

å°†éœ€è¦ä¿®æ”¹çš„æ•°æ®ä»¥ `key:value` çš„å½¢å¼ä¼ ç»™ `this.setData` æ–¹æ³•ã€‚



`this.setData` æ–¹æ³•æœ‰ä¸¤ä¸ªä½œç”¨ï¼š

1. æ›´æ–°æ•°æ®
2. é©±åŠ¨è§†å›¾æ›´æ–°



## ä¿®æ”¹æ™®é€šç±»åž‹æ•°æ®

```js
Page({
  // é¡µé¢çš„åˆå§‹æ•°æ®
  data: {
    num: 1
  },

  updateNum() {
    this.setData({
      // key æ˜¯éœ€è¦ä¿®æ”¹çš„æ•°æ®
      // value æ˜¯æœ€æ–°å€¼
      num: this.data.num + 1
    })
  }
}
```





## ä¿®æ”¹å¯¹è±¡ç±»åž‹æ•°æ®

åœ¨å®žé™…å¼€å‘ä¸­,æˆ‘ä»¬ç»å¸¸ä¼šåœ¨ `data` ä¸­å£°æ˜Žå¯¹è±¡ç±»åž‹çš„æ•°æ®,å°ç¨‹åºä¸­é€šè¿‡è°ƒç”¨ setData æ–¹æ³•å¯ä»¥ä¿®æ”¹é¡µé¢çš„æ•°æ®,åŒ…æ‹¬å¯¹è±¡ç±»åž‹çš„æ•°æ®ã€‚ä¸‹é¢æ˜¯ä¿®æ”¹å¯¹è±¡ç±»åž‹æ•°æ®çš„æ–¹æ³•ï¼š



1. å®šä¹‰ä¸€ä¸ªå¯¹è±¡

   ```json
   Page({
     // å®šä¹‰é¡µé¢ä¸­ä½¿ç”¨çš„æ•°æ®
     data: {
       userInfo: {
         name: 'Tom',
         age: 10,
         gender: 'ç”·'
       }
     }
   }
   ```

   

2. ä¿®æ”¹å¯¹è±¡ä¸­çš„å•ä¸ªå±žæ€§ï¼š

   ```json
   this.setData({
     'userInfo.name': 'Jerry'
   })
   ```

   

3. ä¿®æ”¹å¯¹è±¡ä¸­çš„å¤šä¸ªå±žæ€§

   ```json
   // ä¿®æ”¹å¯¹è±¡ä¸­çš„å¤šä¸ªå±žæ€§
   this.setData({
     'userInfo.name': 'Jerry',
     'userInfo.age': 100
   })
   ```

   

4. ä½¿ç”¨ ES6 çš„å±•å¼€è¿ç®—ç¬¦

   åœ¨ä¿®æ”¹å¯¹è±¡ç±»åž‹çš„æ•°æ®æ—¶,å¯ä»¥ä½¿ç”¨ ES6 çš„å±•å¼€è¿ç®—ç¬¦å…ˆå¤åˆ¶å¯¹è±¡,ç„¶åŽåˆ©ç”¨æ–°å€¼å¯¹æ—§å€¼è¦†ç›–çš„æ–¹å¼ä¿®æ”¹

   ```js
   const userInfo = {
     ...this.data.userInfo,
     name: 'Jerry',
     age: 100
   }
   
   // ä¿®æ”¹å¯¹è±¡ä¸­çš„å¤šä¸ªå±žæ€§
   this.setData({
     userInfo
   })
   ```

   

5. ä½¿ç”¨è§£æž„èµ‹å€¼ä¿®æ”¹å¯¹è±¡å±žæ€§

   åœ¨ä¿®æ”¹å¯¹è±¡ç±»åž‹çš„æ•°æ®æ—¶,å¯ä»¥ä½¿ç”¨è§£æž„èµ‹å€¼æ¥ä¿®æ”¹å¯¹è±¡å±žæ€§

   ```js
   // å°† userInfo ä»Ž data ä¸­è¿›è¡Œè§£æž„
   const { userInfo } = this.data
   // äº§ç”Ÿä¸€ä»½æ–°æ•°æ®
   const newUserInfo = {
     ...userInfo,
     name: 'Jerry',
     age: 100
   }
   // ä¿®æ”¹å¯¹è±¡ä¸­çš„å¤šä¸ªå±žæ€§
   this.setData({
     userInfo: newUserInfo
   })
   ```

   

6. ä½¿ç”¨ Object.assign æ–¹æ³•åˆå¹¶å¯¹è±¡

   åœ¨ä¿®æ”¹å¯¹è±¡ç±»åž‹çš„æ•°æ®æ—¶,å¯ä»¥ä½¿ç”¨ Object.assign æ–¹æ³•å°†å¤šä¸ªå¯¹è±¡åˆå¹¶ä¸ºä¸€ä¸ªå¯¹è±¡

   ```js
   // ä½¿ç”¨ Object.assign æ–¹æ³•å°†å¤šä¸ªå¯¹è±¡åˆå¹¶ä¸ºä¸€ä¸ªå¯¹è±¡
   const userInfo = Object.assign(
     this.data.userInfo, 
     { name: 'Jerry' },
     { age: 100 }
   )
   
   // ä¿®æ”¹å¯¹è±¡ä¸­çš„å¤šä¸ªå±žæ€§
   this.setData({
     userInfo
   })
   ```



7. åˆ é™¤å¯¹è±¡ä¸­çš„å±žæ€§

   åœ¨åˆ é™¤å¯¹è±¡ä¸­çš„å±žæ€§æ—¶,ä¸èƒ½ä½¿ç”¨ `delete` æ“ä½œç¬¦,å› ä¸ºå°ç¨‹åºçš„æ•°æ®ç»‘å®šæœºåˆ¶ä¸æ”¯æŒç›‘å¬ delete æ“ä½œ

   ```js
   // ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦æ‹·è´ä¸€ä»½æ•°æ®,äº§ç”Ÿä¸€ä¸ªæ–°å¯¹è±¡
   const newUser = { ...this.data.userInfo }
   // ä½¿ç”¨ delete åˆ é™¤æ–°å¯¹è±¡ä¸­çš„å±žæ€§
   delete newUser.age
   
   this.setData({
     // å°†æ–°çš„å¯¹è±¡è¿›è¡Œèµ‹å€¼
     userInfo: newUser
   })
   ```

   



> ðŸ“Œ **æ³¨æ„äº‹é¡¹**ï¼š
>
> å°ç¨‹åºçš„æ•°æ®ç»‘å®šæœºåˆ¶åªèƒ½ç›‘å¬åˆ° setData æ–¹æ³•ä¸­ä¿®æ”¹çš„æ•°æ®,æ— æ³•ç›‘å¬åˆ°ç›´æŽ¥åˆ é™¤å±žæ€§çš„æ“ä½œ,æ‰€ä»¥åœ¨åˆ é™¤å¯¹è±¡å±žæ€§æ—¶,éœ€è¦å…ˆå°†å¯¹è±¡å¤åˆ¶ä¸€ä»½å†è¿›è¡Œæ“ä½œ,ç„¶åŽå†è°ƒç”¨ setData æ–¹æ³•æ›´æ–°æ•°æ®ã€‚







## ä¿®æ”¹æ•°ç»„ç±»åž‹æ•°æ®



æ•°ç»„ç±»åž‹æ•°æ®ä¹Ÿæ˜¯ç»å¸¸ä¼šä½¿ç”¨çš„æ•°æ®æ ¼å¼ä¹‹ä¸€,ä¸‹é¢æ˜¯ä¿®æ”¹æ•°ç»„ç±»åž‹æ•°æ®çš„æ–¹æ³•ï¼š



1. å®šä¹‰ä¸€ä¸ªæ•°ç»„

   ```js
   Page({
     // å®šä¹‰é¡µé¢ä¸­ä½¿ç”¨çš„æ•°æ®
     data: {
       animalList: ['Tom', 'Jerry', 'Spyke']
     }
   
     // coding...
   }
   ```

   

2. ä½¿ç”¨æ•°ç»„çš„ concat æ–¹æ³•åˆå¹¶æ•°ç»„

   åœ¨ä¿®æ”¹æ•°ç»„ç±»åž‹çš„æ•°æ®æ—¶,å¯ä»¥ä½¿ç”¨æ•°ç»„çš„ concat æ–¹æ³•æ¥åˆå¹¶æ•°ç»„

   ```js
   // ä½¿ç”¨ concat æ–¹æ³•æ¥åˆå¹¶æ•°ç»„
   const newList = this.data.animalList.concat('Tyke')
   
   // ä½¿ç”¨ setData è¿›è¡Œèµ‹å€¼
   this.setData({
     animalList: newList
   })
   ```

   

3. ä½¿ç”¨æ•°ç»„çš„ push æ–¹æ³•æ–°å¢žå±žæ€§

   åœ¨ä¿®æ”¹æ•°ç»„ç±»åž‹çš„æ•°æ®æ—¶,å¯ä»¥ä½¿ç”¨æ•°ç»„çš„ push æ–¹æ³•æ¥æ·»åŠ å…ƒç´ 

   ```js
   // ä½¿ç”¨æ•°ç»„çš„ push æ–¹æ³•æ¥æ·»åŠ å…ƒç´ 
   this.data.animalList.push('Tyke')
   
   // ä½¿ç”¨ setData è¿›è¡Œèµ‹å€¼
   this.setData({
     animalList: this.data.animalList
   })
   ```

   

4. ä½¿ç”¨ ES6 çš„å±•å¼€è¿ç®—ç¬¦

   åœ¨æ•°ç»„ç±»åž‹çš„æ•°æ®æ—¶,å¯ä»¥ä½¿ç”¨ ES6 çš„å±•å¼€è¿ç®—ç¬¦å…ˆå¤åˆ¶æ•°ç»„,ç„¶åŽè¿›è¡Œåˆå¹¶

   ```js
   // ä½¿ç”¨ ES6 çš„å±•å¼€è¿ç®—ç¬¦å…ˆå¤åˆ¶æ•°ç»„,ç„¶åŽè¿›è¡Œåˆå¹¶
   const newList = [...this.data.animalList, 'Tyke']
   
   // ä½¿ç”¨ setData è¿›è¡Œèµ‹å€¼
   this.setData({
     animalList: newList
   })
   ```

5. ä¿®æ”¹æ•°ç»„ä¸­æŸä¸ªå…ƒç´ çš„å€¼ï¼š

   åˆ©ç”¨ç´¢å¼•çš„æ–¹å¼è¿›è¡Œä¿®æ”¹,ä½†å¿…é¡»ä½¿ç”¨ wx:for æ¥è¿›è¡Œæ¸²æŸ“æ•°ç»„,å¦åˆ™ä¼šå‡ºçŽ°é”™è¯¯

   ```js
   this.setData({
     'animalList[2]': 'Tyke' 
   })
   ```

   

6. ä½¿ç”¨æ•°ç»„çš„ filter æ–¹æ³•åˆ é™¤å…ƒç´ 

   åœ¨ä¿®æ”¹æ•°ç»„ç±»åž‹çš„æ•°æ®æ—¶,å¯ä»¥ä½¿ç”¨æ•°ç»„çš„ filter æ–¹æ³•æ¥åˆ é™¤å…ƒç´ 

   ```js
   // ä½¿ç”¨æ•°ç»„çš„ filter æ–¹æ³•æ¥åˆ é™¤å…ƒç´ 
   const newList = this.data.animalList.filter(item => item !== 'Tom')
   
   // ä½¿ç”¨ setData è¿›è¡Œèµ‹å€¼
   this.setData({
     animalList: newList
   })
   ```

